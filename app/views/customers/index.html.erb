<% content_for(:title) {'Orders'} %>

<table class="table table-striped table-bordered table-hover">
  <thead class="table-dark">
    <tr>
      <th>Customer Id</th>
      <th>First Name</th>
      <th>Last Name</th>
      <th>Email</th>
      <th>Phone</th>
      <th>Total Orders</th>
      <th colspan="3"></th>
    </tr>
  </thead>

<tbody>
<% @results.flatten.each_with_index do |customerorder,index| %>
  <tr>
    <td><%= customerorder["customer_id"] %></td>
    <td><%= customerorder["billing_address"]["first_name"] %></td>
    <td><%= customerorder["billing_address"]["last_name"] %></td>
    <td><%= customerorder["billing_address"]["email"] %></td>
    <td><%= customerorder["billing_address"]["phone"] %></td>
    <td><%= @customerorders.group_by{|a| a["customer_id"]}.values[index].count %></td>
    <td><%= link_to 'Show', orders_details_path %></td>
  </tr>
<% end %>
  <tr>
    <td colspan="5"></td>
    <td><%= @customerorders.count %></td>
    <td colspan="3"></td>
  </tr>
</tbody>
</table>
